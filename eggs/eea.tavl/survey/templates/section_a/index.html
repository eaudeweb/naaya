{% load utils %}


{% include "section_a/header.html" %}

{% for category in categories_section_a %}
  <div class="answers-container">
    <h4>{{ category }}</h4>
    {% if category.description %}
      <p>{{ category.description|linebreaks }}</p>
    {% endif %}

    {% assign sections|get_answers:category as answers %}
    {% assign sections|get_answers_for_user:category as user_answers %}

    {% if not category.for_user %}
      <div id="section-a-answers-{{ category.id }}">
      {% for survey in answers %}
        {% include "section_a/preview.html" %}
      {% endfor %}
      </div>
    {% else %}
      <div id="section-a-user-answers-{{ category.id }}">
        {% for survey in user_answers %}
          {% include "section_a/preview_comment.html" %}
        {% endfor %}
      </div>
      {% if not user_answers %}
        <a data-href="{% url survey:edit category.id %}"
           class="add" data-target="#section-a-user-answers-{{ category.id }}"
           data-closetext="Close"
           data-opentext="Add comment">
           Add comment</a>
      {% endif %}
    {% endif %}

    {% if category.multiple_answers or not answers %}
      {% if not category.for_user %}
        <a data-href="{% url survey:edit category.id %}"
           class="add" data-target="#section-a-answers-{{ category.id }}"
           data-multiple="{{ category.multiple_answers|lower }}"
           data-closetext="Close"
           data-opentext="Add another">Add another</a>
      {% endif %}
    {% endif %}

    <div class="add-container" style="display: none;"></div>
  </div>

{% endfor %}

